{{/* Shortcode: img
   Usage: {{< img src="images/foo.jpg" alt="Alt text" class="..." width="200" height="100" >}}
   Ensures the image `src` is passed through Hugo `relURL` so it's relative to the site's baseURL.
*/}}
{{/* compute relURL then strip the site base path (if any) so generated src is root-relative like /images/... */}}
{{ $src := (.Get "src") | relURL }}
{{ $basepath := replaceRE "^https?://[^/]+" "" .Site.BaseURL }}
{{ $basepath = strings.TrimRight $basepath "/" }}
{{ $src = replaceRE (printf "^%s" $basepath) "" $src }}
<img src="{{ $src }}"{{ with .Get "alt" }} alt="{{ . }}"{{ end }}{{ with .Get "class" }} class="{{ . }}"{{ end }}{{ with .Get "width" }} width="{{ . }}"{{ end }}{{ with .Get "height" }} height="{{ . }}"{{ end }}{{ with .Get "title" }} title="{{ . }}"{{ end }}>
